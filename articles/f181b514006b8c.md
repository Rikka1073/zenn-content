---
title: "GitHub Actions ã§EC2 ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹CI/CD ç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["aws", "ec2", "githubactions", "cicd"]
published: false
publication_name: "jisou"
---

# ã¯ã˜ã‚ã«

ä»Šå›ã¯ Github Actoins ã‚’ä½¿ã£ã¦ EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã« CI/CD ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ãã¾ã™ã€‚
EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®è¨­å®šæ–¹æ³•ã«ã¤ã„ã¦ã¯ä¸‹è¨˜ã®è¨˜äº‹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚

https://zenn.dev/jisou/articles/5f90cfa51986c8

# éµã®ç”Ÿæˆã¨ç™»éŒ²

## éµã®ç”Ÿæˆ

GitHub Actions ãŒ EC2 ã« SSH æ¥ç¶šã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®éµã‚’ä½œæˆã—ã¾ã™ã€‚

1. EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ¥ç¶šã—ã¾ã™ã€‚

```
ssh -i ~/.ssh/xxx.pem ec2-user@IPã‚¢ãƒ‰ãƒ¬ã‚¹
```

2. .ssh ã«ç§»å‹•ã—ã¾ã™ã€‚

```
cd ~/.ssh
```

3. éµã‚’ä½œæˆã—ã¾ã™ã€‚

```
ssh-keygen -t rsa
```

4. å…¨ã¦ Enter ã‚’æŠ¼ã™ã¨ id_rsaï¼ˆç§˜å¯†éµï¼‰id_rsa.pubï¼ˆå…¬é–‹éµï¼‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

```
Enter file in which to save the key ():  // Enter
Enter passphrase (empty for no passphrase):  // Enter
Enter same passphrase again:  // Enter
```

5. .ssh ã§ ls ã‚³ãƒãƒ³ãƒ‰ã§ä¸‹è¨˜ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°å®Œäº†ã§ã™ã€‚

```
authorized_keys  id_rsa  id_rsa.pub
```

6. å…¬é–‹éµã‚’ EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã® ~/.ssh/authorized_keys ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™ã€‚æ—¢å­˜ã®ã‚­ãƒ¼ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹å ´åˆã¯å‰Šé™¤ã›ãšæ–°ã—ã„è¡Œã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

- å…¬é–‹éµã®å†…å®¹ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```
cat ~/.ssh/id_rsa.pub
```

- è¡¨ç¤ºã•ã‚ŒãŸå†…å®¹ã‚’ã€EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã® ~/.ssh/authorized_keys ã«è¿½åŠ ã—ã¾ã™ã€‚

```
ssh-rsa xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx //æ—¢å­˜ã®ã‚­ãƒ¼

ssh-rsa 00000000000000000000000000000000000000000000000 //è¿½åŠ ã™ã‚‹ã‚­ãƒ¼
```

## éµã®ç™»éŒ²

ç”Ÿæˆã—ãŸéµã‚’ GitHub ã«ç™»éŒ²ã—ã¦ã„ãã¾ã™ã€‚

1. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§éµã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™

```
$ cat ~/.ssh/id_rsa.pub

```

2. Github ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™

![](https://storage.googleapis.com/zenn-user-upload/018de788cfb7-20250420.png)

3. Settings ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™

![](https://storage.googleapis.com/zenn-user-upload/3ebc5b2e60dd-20250420.png)

4. SSH and GPG keys ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™

![](https://storage.googleapis.com/zenn-user-upload/10e486dc9cca-20250420.png)

5. New SSH key ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™

![](https://storage.googleapis.com/zenn-user-upload/08c7304d13f0-20250420.png)

6. ä»Šå›å…¥åŠ›ã™ã‚‹è¨­å®šé …ç›®ã§ã™ã€‚Title ã«ã¯è¦ä»¶ã«åˆã†é©å½“ãªåå‰ã‚’ã¤ã‘ã€key ã®éƒ¨åˆ†ã«ç§˜å¯†éµã®ä¸­èº«ã‚’å…¥ã‚Œã¾ã™ã€‚

| é …ç›®  | å€¤              |
| ----- | --------------- |
| Title | ec2_auto_deploy |
| Key   | å…¬é–‹éµã®ä¸­èº«    |

- å…¬é–‹éµã®å†…å®¹ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```
cat ~/.ssh/id_rsa.pub
```

![](https://storage.googleapis.com/zenn-user-upload/23b533125f9d-20250420.png)

7. å…¥åŠ›å†…å®¹ãŒå•é¡Œãªã‘ã‚Œã° Add ssh key ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/142031912428-20250420.png)

8. Authentication keys ã®ã‚¢ã‚¤ã‚³ãƒ³ãªã©ãŒç°è‰²ã«ãªã£ã¦ã„ã‚Œã°å®Œäº†ã§ã™ã€‚æ¥ç¶šãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨ç·‘è‰²ã«å¤‰åŒ–ã—ã¾ã™ã€‚

- key ã®éƒ¨åˆ†ã«ç§˜å¯†éµã®ä¸­èº«ã‚’å…¥ã‚Œã¾ã™ã€‚ï¼ˆ-----BEGIN RSA PRIVATE KEY----- ã‹ã‚‰ -----END RSA PRIVATE KEY----- ã®å†…å®¹ã‚’å…¨ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚ï¼‰
